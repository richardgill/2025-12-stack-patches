diff --git a/packages/auth/src/index.ts b/packages/auth/src/index.ts
index 3453659..30f2c2d 100644
--- a/packages/auth/src/index.ts
+++ b/packages/auth/src/index.ts
@@ -4,36 +4,53 @@ import * as schema from "@2025-12-stack/db/schema/auth";
 import { type BetterAuthOptions, betterAuth } from "better-auth";
 import { drizzleAdapter } from "better-auth/adapters/drizzle";
 
-export const auth = betterAuth<BetterAuthOptions>({
-	database: drizzleAdapter(db, {
-		provider: "pg",
+const getTrustedOrigins = (request: Request) => {
+	const origin = request.headers.get("origin");
+	if (!origin) return env.CORS_ORIGIN ? [env.CORS_ORIGIN] : [];
+	if (
+		origin.endsWith(".workers.dev") ||
+		origin.endsWith(".pages.dev") ||
+		origin.includes("localhost")
+	) {
+		return [origin];
+	}
+	return env.CORS_ORIGIN ? [env.CORS_ORIGIN] : [];
+};
 
-		schema: schema,
-	}),
-	trustedOrigins: [env.CORS_ORIGIN],
-	emailAndPassword: {
-		enabled: true,
-	},
-	// uncomment cookieCache setting when ready to deploy to Cloudflare using *.workers.dev domains
-	// session: {
-	//   cookieCache: {
-	//     enabled: true,
-	//     maxAge: 60,
-	//   },
-	// },
-	secret: env.BETTER_AUTH_SECRET,
-	baseURL: env.BETTER_AUTH_URL,
-	advanced: {
-		defaultCookieAttributes: {
-			sameSite: "none",
-			secure: true,
-			httpOnly: true,
+export const createAuth = (baseURL: string) => {
+	const isSecure = baseURL.startsWith("https://");
+	return betterAuth<BetterAuthOptions>({
+		database: drizzleAdapter(db, {
+			provider: "pg",
+			schema: schema,
+		}),
+		trustedOrigins: getTrustedOrigins,
+		emailAndPassword: {
+			enabled: true,
 		},
-		// uncomment crossSubDomainCookies setting when ready to deploy and replace <your-workers-subdomain> with your actual workers subdomain
-		// https://developers.cloudflare.com/workers/wrangler/configuration/#workersdev
-		// crossSubDomainCookies: {
-		//   enabled: true,
-		//   domain: "<your-workers-subdomain>",
-		// },
-	},
-});
+		// uncomment cookieCache setting when ready to deploy to Cloudflare using *.workers.dev domains
+		session: {
+			cookieCache: {
+				enabled: true,
+				maxAge: 60 * 60 * 24,
+			},
+		},
+		secret: env.BETTER_AUTH_SECRET,
+		baseURL,
+		advanced: {
+			defaultCookieAttributes: {
+				sameSite: isSecure ? "none" : "lax",
+				secure: isSecure,
+				httpOnly: true,
+			},
+			// uncomment crossSubDomainCookies setting when ready to deploy and replace <your-workers-subdomain> with your actual workers subdomain
+			// https://developers.cloudflare.com/workers/wrangler/configuration/#workersdev
+			crossSubDomainCookies: {
+				enabled: true,
+				domain: "richardgill88.workers.dev",
+			},
+		},
+	});
+};
+
+export type Auth = ReturnType<typeof createAuth>;
